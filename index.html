<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üå∏ Sakura Hanabi</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: black;
    overflow: hidden;
    height: 100%;
}

canvas {
    display: block;
}

/* Orientation warning */
#rotateWarning {
    position: fixed;
    inset: 0;
    background: black;
    color: white;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    z-index: 10;
}
</style>
</head>
<body>

<div id="rotateWarning">üì± ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡∏à‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á<br>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏û‡∏•‡∏∏</div>
<canvas id="canvas"></canvas>

<audio id="boomSound" preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2b5c8b88f4.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const warning = document.getElementById("rotateWarning");
const boom = document.getElementById("boomSound");

let W, H;
let petals = [];
let sparkles = [];
let lastFirework = 0;

function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* Orientation check */
function checkOrientation() {
    if (window.innerHeight > window.innerWidth) {
        warning.style.display = "none";
    } else {
        warning.style.display = "flex";
    }
}
window.addEventListener("resize", checkOrientation);
checkOrientation();

/* Utility */
const rand = (a,b)=>Math.random()*(b-a)+a;

/* Sakura petal */
class Petal {
    constructor(x,y,color,angle,speed) {
        this.x = x;
        this.y = y;
        this.angle = angle;
        this.speed = speed;
        this.life = rand(60,100);
        this.size = rand(6,10);
        this.color = color;
        this.rotation = rand(0,Math.PI*2);
    }
    draw() {
        ctx.save();
        ctx.translate(this.x,this.y);
        ctx.rotate(this.rotation);
        ctx.globalAlpha = this.life/100;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.moveTo(0,-this.size);
        ctx.quadraticCurveTo(this.size,this.size,0,this.size*1.4);
        ctx.quadraticCurveTo(-this.size,this.size,0,-this.size);
        ctx.fill();
        ctx.restore();
    }
    update() {
        this.x += Math.cos(this.angle)*this.speed;
        this.y += Math.sin(this.angle)*this.speed;
        this.y += 0.3;
        this.rotation += 0.05;
        this.life--;
    }
}

/* Sparkle tail */
class Sparkle {
    constructor(x,y,color) {
        this.x=x;
        this.y=y;
        this.vx=rand(-1.5,1.5);
        this.vy=rand(-1.5,1.5);
        this.life=30;
        this.color=color;
    }
    draw() {
        ctx.globalAlpha=this.life/30;
        ctx.fillStyle=this.color;
        ctx.fillRect(this.x,this.y,2,2);
    }
    update() {
        this.x+=this.vx;
        this.y+=this.vy;
        this.life--;
    }
}

/* Firework */
function launchFirework() {
    if (warning.style.display !== "none") return;

    const cx = rand(W*0.2,W*0.8);
    const cy = rand(H*0.2,H*0.4);
    const maxRadius = Math.min(W,H)*0.6;

    boom.currentTime = 0;
    boom.play();

    const colors = [
        "#ff9ecf","#ffd1dc","#ffffff",
        "#ff6fa5","#ffcce6"
    ];

    const layers = 3;
    for (let l=0;l<layers;l++) {
        const count = 80;
        for (let i=0;i<count;i++) {
            const angle = (Math.PI*2/count)*i;
            const speed = rand(2,4)+(l*0.8);
            const color = colors[Math.floor(Math.random()*colors.length)];
            petals.push(new Petal(cx,cy,color,angle,speed));
        }
    }

    for (let i=0;i<120;i++) {
        sparkles.push(new Sparkle(cx,cy,"#fff"));
    }
}

/* Animation loop */
function animate() {
    ctx.fillStyle="rgba(0,0,0,0.25)";
    ctx.fillRect(0,0,W,H);

    petals = petals.filter(p=>p.life>0);
    sparkles = sparkles.filter(s=>s.life>0);

    petals.forEach(p=>{p.update();p.draw();});
    sparkles.forEach(s=>{s.update();s.draw();});

    const now = performance.now();
    if (now-lastFirework>3000) {
        launchFirework();
        lastFirework=now;
    }

    requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
